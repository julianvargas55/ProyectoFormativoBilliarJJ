import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;

import sena.jj.com.service.PedidoService;

import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.ui.Model; // Si estás usando Thymeleaf o JSP

@Controller
public class PedidoController {

    // 1. Inyecta el Servicio
    @Autowired
    private PedidoService pedidoService;

    // 2. Mapea la URL del formulario de confirmación
    @PostMapping("/usuario/realizar-pedido")
    // @ModelAttribute automáticamente toma los campos del formulario 
    // y los mapea a un objeto 'Pedido'
    public String procesarYGuardarPedido(@ModelAttribute Pedido nuevoPedido) {
        
        // 3. ✨ Llama al Servicio para que guarde el objeto en la BD
        pedidoService.guardarPedido(nuevoPedido); 
        
        // Puedes añadir una confirmación o el ID del pedido si es necesario
        
        // 4. Redirige al usuario a una página de éxito
        return "redirect:/usuario/pedido-exitoso"; 
    }

    // 5. Crea la página de éxito (vista)
    // @GetMapping("/usuario/pedido-exitoso")
    // public String mostrarExito() {
    //     return "pedido_exitoso"; // Nombre de tu archivo HTML/JSP
    // }
}